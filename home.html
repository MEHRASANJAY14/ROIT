<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Home Loan Eligibility & EMI Schedule</title>

<style>
body{
font-family:Arial, sans-serif;
background:linear-gradient(135deg,#003300,#009933);
margin:0;
padding:15px;
}

.container{
max-width:1100px;
width:100%;
background:#ffffff;
padding:25px;
margin:auto;
border-radius:12px;
box-shadow:0 10px 25px rgba(0,0,0,0.3);
box-sizing:border-box;
}

h2{
text-align:center;
color:#003300;
margin-bottom:20px;
}

.form-grid{
display:grid;
grid-template-columns:repeat(auto-fit, minmax(250px,1fr));
gap:15px;
}

.form-group{
display:flex;
flex-direction:column;
}

label{
font-weight:bold;
margin-bottom:5px;
}

.small-note{
font-size:11px;
color:#666;
margin-top:3px;
}

input,select{
padding:10px;
border-radius:6px;
border:1px solid #ccc;
width:100%;
box-sizing:border-box;
}

button{
width:100%;
padding:12px;
background:#003300;
color:white;
border:none;
border-radius:8px;
margin-top:20px;
font-size:16px;
cursor:pointer;
}

button:hover{background:#001a00;}

#resultSection{
margin-top:30px;
display:none;
}

.summary-box{
border:2px solid #003300;
padding:15px;
background:#f9fff9;
margin-bottom:20px;
border-radius:8px;
}

.table-wrapper{
overflow-x:auto;
}

table{
min-width:700px;
width:100%;
border-collapse:collapse;
font-size:13px;
}

th,td{
border:1px solid #ccc;
padding:6px;
text-align:center;
}

th{
background:#003300;
color:white;
}

@media print{
body{background:white;padding:0;}
form, button{display:none;}
}
</style>
</head>

<body>

<div class="container">

<h2>üè¶ HOME LOAN ELIGIBILITY & EMI AMORTIZATION</h2>

<form id="loanForm">

<div class="form-grid">

<div class="form-group">
<label>Applicant Name</label>
<input type="text" id="name" required>
</div>

<div class="form-group">
<label>Employment Type</label>
<select id="employment" required>
<option value="">Select</option>
<option value="salaried">Salaried</option>
<option value="business">Business</option>
<option value="professional">Professional</option>
</select>
</div>

<div class="form-group">
<label>Loan Purpose</label>
<select id="purpose" required>
<option value="">Select</option>
<option>Purchase</option>
<option>Construction</option>
<option>Top-Up</option>
<option>Repair/Renovation</option>
<option>Extension</option>
</select>
</div>

<div class="form-group">
<label id="incomeLabel">Monthly Gross Income (As per Salary Slip) (‚Çπ)</label>
<input type="number" id="income" required>
<div class="small-note" id="incomeNote">
Enter Gross Monthly Salary before deductions.
</div>
</div>

<div class="form-group">
<label>Existing EMI Obligations (‚Çπ)</label>
<input type="number" id="existingEmi" required>
</div>

<div class="form-group">
<label>Base Interest Rate (%)</label>
<input type="number" id="roi" required>
</div>

<div class="form-group">
<label>Requested Tenure (Years)</label>
<input type="number" id="tenure" required>
</div>

<div class="form-group">
<label>Applicant Age</label>
<input type="number" id="age" required>
</div>

<div class="form-group">
<label>Property Value (‚Çπ)</label>
<input type="number" id="property" required>
</div>

<div class="form-group">
<label>CIBIL Score</label>
<input type="number" id="cibil" min="300" max="900" required>
</div>

</div>

<button type="submit">Generate Eligibility & Schedule</button>

</form>

<div id="resultSection">

<div class="summary-box" id="summaryBox"></div>

<h3>üìä EMI Amortization Schedule</h3>

<div class="table-wrapper">
<table>
<thead>
<tr>
<th>Month</th>
<th>Opening</th>
<th>EMI</th>
<th>Interest</th>
<th>Principal</th>
<th>Closing</th>
</tr>
</thead>
<tbody id="scheduleBody"></tbody>
</table>
</div>

<button onclick="window.print()">Print Report</button>

</div>

</div>

<script>

/* Income Label Auto Change */
document.getElementById("employment").addEventListener("change", function(){

let type = this.value;
let label = document.getElementById("incomeLabel");
let note = document.getElementById("incomeNote");

if(type === "salaried"){
label.innerHTML = "Monthly Gross Income (As per Salary Slip) (‚Çπ)";
note.innerHTML = "Enter Gross Monthly Salary before deductions.";
}
else{
label.innerHTML = "Average Monthly Income (As per ITR) (‚Çπ)";
note.innerHTML = "Enter Average Monthly Income based on last 2‚Äì3 years ITR.";
}
});


/* Eligibility Logic */
document.getElementById("loanForm").addEventListener("submit", function(e){

e.preventDefault();

let incomeVal = Number(document.getElementById("income").value);
let existingEmiVal = Number(document.getElementById("existingEmi").value);
let rateVal = Number(document.getElementById("roi").value);
let tenureYearsVal = Number(document.getElementById("tenure").value);
let ageVal = Number(document.getElementById("age").value);
let propertyVal = Number(document.getElementById("property").value);
let cibilVal = Number(document.getElementById("cibil").value);

/* CIBIL Check */
if(cibilVal < 650){
alert("Not Eligible ‚Äì CIBIL below 650");
return;
}

/* Age Based Tenure */
let retirementAge = 60;
let maxTenure = retirementAge - ageVal;
if(maxTenure <= 0){
alert("Age beyond retirement");
return;
}

let finalTenureYears = Math.min(tenureYearsVal, maxTenure, 30);
let months = finalTenureYears * 12;

/* EMI Eligibility % (Circular Language Instead of FOIR) */
let emiEligibilityPercent =
incomeVal <= 100000 ? 40 :
incomeVal <= 500000 ? 30 : 25;

let eligibleEmi = (incomeVal * emiEligibilityPercent / 100) - existingEmiVal;

if(eligibleEmi <= 10000){
alert("Minimum ‚Çπ10,000 residual income not maintained");
return;
}

/* CIBIL Concession */
let finalRate = rateVal;
if(cibilVal >= 800) finalRate -= 0.50;
else if(cibilVal >= 725) finalRate -= 0.40;

let monthlyRate = finalRate / 100 / 12;

/* Loan based on Income */
let loanIncome = eligibleEmi *
((Math.pow(1+monthlyRate, months)-1) /
(monthlyRate*Math.pow(1+monthlyRate, months)));

/* LTV Based on Property */
let ltv = propertyVal <= 3000000 ? 0.90 :
propertyVal <= 7500000 ? 0.80 : 0.75;

let finalLoan = Math.min(loanIncome, propertyVal * ltv);

/* EMI Calculation */
let emi = finalLoan * monthlyRate *
Math.pow(1+monthlyRate, months) /
(Math.pow(1+monthlyRate, months)-1);

/* Show Result */
document.getElementById("resultSection").style.display="block";

document.getElementById("summaryBox").innerHTML = `
<b>EMI Eligibility % Applied:</b> ${emiEligibilityPercent}% <br>
<b>Eligible Loan Amount:</b> ‚Çπ ${Math.round(finalLoan)} <br>
<b>Estimated EMI:</b> ‚Çπ ${Math.round(emi)} <br>
<b>Interest Rate Applied:</b> ${finalRate.toFixed(2)}% <br>
<b>Tenure Approved:</b> ${finalTenureYears} Years
`;

/* Amortization Schedule */
let balance = finalLoan;
let scheduleHTML = "";

for(let i=1; i<=months; i++){

let interest = balance * monthlyRate;
let principal = emi - interest;
let closing = balance - principal;

scheduleHTML += `
<tr>
<td>${i}</td>
<td>${balance.toFixed(0)}</td>
<td>${emi.toFixed(0)}</td>
<td>${interest.toFixed(0)}</td>
<td>${principal.toFixed(0)}</td>
<td>${closing.toFixed(0)}</td>
</tr>
`;

balance = closing;
}

document.getElementById("scheduleBody").innerHTML = scheduleHTML;

});
</script>

</body>
</html>
