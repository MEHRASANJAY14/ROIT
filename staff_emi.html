<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Staff Loan EMI - MPGB RO Jabalpur</title>

<style>
body{
  margin:0;
  font-family:'Segoe UI',Arial;
  background:linear-gradient(135deg,#e8f5e9,#ffffff);
}

.header{
  background:#006400;
  color:white;
  text-align:center;
  padding:18px;
  font-size:20px;
  font-weight:bold;
}

.container{
  max-width:1300px;
  margin:30px auto;
  background:white;
  padding:25px;
  border-radius:12px;
  box-shadow:0 10px 25px rgba(0,0,0,0.1);
}

input{
  padding:8px;
  width:100%;
  border:1px solid #ccc;
  border-radius:6px;
  margin-bottom:10px;
}

button{
  background:#006400;
  color:white;
  border:none;
  padding:10px;
  border-radius:6px;
  font-weight:bold;
  cursor:pointer;
}

button:hover{background:#004d00;}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
  font-size:11px;
}

th,td{
  border:1px solid #ccc;
  padding:6px;
  text-align:center;
  vertical-align:top;
}

th{
  background:#006400;
  color:white;
}

.result{
  margin-top:20px;
  background:#f1f8f4;
  padding:15px;
  border-radius:8px;
}
</style>
</head>

<body>

<div class="header">
MPGB RO Jabalpur - Staff Loan EMI (Tier Based 3:1 Model)
</div>

<div class="container">

<h2>Staff Loan Calculator</h2>

<input type="number" id="amount" placeholder="Loan Amount (₹)">
<input type="number" id="tenure" placeholder="Tenure (Months)">

<button onclick="calculateStaff()">Calculate</button>

<div class="result" id="summary" style="display:none;"></div>

<table id="schedule"></table>

</div>

<script>

function format(n){
  return n.toLocaleString("en-IN",{maximumFractionDigits:2});
}

function calculateStaff(){

let P=parseFloat(document.getElementById("amount").value);
let totalMonths=parseInt(document.getElementById("tenure").value);

if(!P||!totalMonths){
  alert("Fill all fields");
  return;
}

/* 3:1 Ratio */
let principalMonths=Math.round((3/4)*totalMonths);
let interestMonths=totalMonths-principalMonths;

/* Slab Split */
let slab1=Math.min(P,4000000);
let slab2=P>4000000?P-4000000:0;

let balance1=slab1;
let balance2=slab2;

let monthlyPrincipal=P/principalMonths;

let r1=5.5/12/100;
let r2=6/12/100;

let accumulatedInterest=0;
let slab1InterestTotal=0;
let slab2InterestTotal=0;

let table=document.getElementById("schedule");

table.innerHTML=
"<tr>\
<th>Month</th>\
<th>Principal Repayment</th>\
<th>Interest (Slab1 @5.5% + Slab2 @6%)</th>\
<th>Outstanding Breakup</th>\
</tr>";

/* -------- Phase 1 : Principal Repayment -------- */

for(let i=1;i<=principalMonths;i++){

  let reductionRatio = monthlyPrincipal / P;

  let principal1 = balance1 * reductionRatio;
  let principal2 = balance2 * reductionRatio;

  let interest1 = balance1*r1;
  let interest2 = balance2*r2;

  let totalInterestMonth = interest1 + interest2;

  slab1InterestTotal += interest1;
  slab2InterestTotal += interest2;

  accumulatedInterest += totalInterestMonth;

  balance1 -= principal1;
  balance2 -= principal2;

  let principalOutstanding = balance1 + balance2;
  let totalOutstanding = principalOutstanding + accumulatedInterest;

  table.innerHTML+=
  "<tr>\
  <td>"+i+"</td>\
  <td>"+format(monthlyPrincipal)+"</td>\
  <td>"+format(interest1)+" + "+format(interest2)+" = <b>"+format(totalInterestMonth)+"</b></td>\
  <td>\
    Principal: "+format(principalOutstanding)+"<br>\
    + Interest: "+format(accumulatedInterest)+"<br>\
    = <b>"+format(totalOutstanding)+"</b>\
  </td>\
  </tr>";
}

/* -------- Phase 2 : Interest Repayment -------- */

let monthlyInterestRecovery=accumulatedInterest/interestMonths;
let remainingInterest=accumulatedInterest;

for(let i=1;i<=interestMonths;i++){

  remainingInterest-=monthlyInterestRecovery;

  table.innerHTML+=
  "<tr>\
  <td>"+(principalMonths+i)+"</td>\
  <td>0</td>\
  <td>"+format(monthlyInterestRecovery)+"</td>\
  <td>\
    Principal: 0<br>\
    + Interest: "+format(remainingInterest>0?remainingInterest:0)+"<br>\
    = <b>"+format(remainingInterest>0?remainingInterest:0)+"</b>\
  </td>\
  </tr>";
}

/* -------- Summary -------- */

document.getElementById("summary").innerHTML=
"<h3>Summary</h3>\
<p><strong>Slab 1:</strong> ₹ "+format(slab1)+" @ 5.5%</p>\
<p><strong>Slab 2:</strong> ₹ "+format(slab2)+" @ 6%</p>\
<hr>\
<p><strong>Slab 1 Total Interest:</strong> ₹ "+format(slab1InterestTotal)+"</p>\
<p><strong>Slab 2 Total Interest:</strong> ₹ "+format(slab2InterestTotal)+"</p>\
<p><strong>Total Accumulated Interest:</strong> ₹ "+format(accumulatedInterest)+"</p>\
<p><strong>Total Payment (Principal + Interest):</strong> ₹ "+format(P+accumulatedInterest)+"</p>";

document.getElementById("summary").style.display="block";

}

</script>

</body>
</html>
