<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Hardware Inventory Entry</title>

<style>
body{
  font-family:Arial;
  background:#f4f6f9;
  padding:20px
}

.header{
  background:#006400;
  color:white;
  padding:15px;
  text-align:center;
  border-radius:8px;
  margin-bottom:10px;
}

.back-btn{
  display:inline-block;
  margin-bottom:15px;
  padding:8px 15px;
  background:#004d00;
  color:white;
  text-decoration:none;
  border-radius:5px;
}

.card{
  background:white;
  padding:20px;
  border-radius:10px;
  box-shadow:0 4px 8px rgba(0,0,0,0.1)
}

.section-title{
  color:#006400;
  font-weight:bold;
  margin-top:15px;
  margin-bottom:5px;
}

input,select{
  width:100%;
  padding:8px;
  margin:6px 0;
  border:1px solid #ccc;
  border-radius:4px
}

button{
  padding:10px;
  background:#008000;
  color:white;
  border:none;
  width:100%;
  border-radius:5px;
  margin-top:15px
}
</style>
</head>
<body>

<!-- ðŸ”¹ Back Button -->
<a href="index.html" class="back-btn">â¬… Back to Dashboard</a>

<div class="header">
  <h2>Hardware Inventory Entry</h2>
</div>

<div class="card">

<div class="section-title">Branch Details</div>

<select id="branch"></select>
<input id="solid" placeholder="SOL ID" readonly>
<input id="solname" placeholder="SOL NAME" readonly>

<div class="section-title">Hardware Details</div>

<select id="asset">
  <option value="">Select Hardware Type</option>
  <option>CPU</option>
  <option>MONITOR</option>
  <option>SCANNER</option>
  <option>PASSBOOK PRINTER</option>
  <option>LASER PRINTER</option>
  <option>BIOMETRIC DEVICE</option>
  <option>MODEM</option>
  <option>ROUTER</option>
  <option>VC DEVICE</option>
  <option>LED PROJECTOR</option>
  <option>PROJECTOR SCREEN</option>
  <option>SPEAKER</option>
</select>

<input id="brand" placeholder="Brand">
<input id="model" placeholder="Model">
<input id="serial" placeholder="Serial No (Mandatory)">
<input id="assigned" placeholder="Assigned To">

<select id="critical">
  <option value="LOW">LOW</option>
  <option value="MEDIUM">MEDIUM</option>
  <option value="HIGH">HIGH</option>
</select>

<select id="status">
  <option value="">Select Status</option>
  <option>WORKING</option>
  <option>FAULTY</option>
  <option>UNDER REPAIR</option>
  <option>SCRAP</option>
</select>

<select id="windows">
  <option value="">Windows Activated?</option>
  <option>YES</option>
  <option>NO</option>
</select>

<button onclick="saveData()">Save Hardware Asset</button>

</div>

<script>

const API_URL = "https://script.google.com/macros/s/AKfycbz6gx8Ko_Kpgoof9v1gCOy4ajQsNm2O_iL3IM6o2aGHaYYF0QD25q_PxSAyC-uGFcc/exec";

function loadBranches(){
  fetch(API_URL + "?type=branches")
  .then(res=>res.json())
  .then(data=>{
    const select=document.getElementById("branch");
    select.innerHTML="<option value=''>Select Branch</option>";
    data.forEach(row=>{
      let option=document.createElement("option");
      option.value=row[0];
      option.text=row[0]+" - "+row[1];
      select.appendChild(option);
    });
  });
}

document.addEventListener("change",function(e){
  if(e.target.id=="branch"){
    const text=e.target.options[e.target.selectedIndex].text;
    document.getElementById("solid").value=e.target.value;
    document.getElementById("solname").value=text.split(" - ")[1];
  }
});

function saveData(){

  if(!branch.value){
    alert("Select Branch");
    return;
  }

  if(!asset.value){
    alert("Select Hardware Type");
    return;
  }

  if(!serial.value){
    alert("Serial Number Mandatory");
    return;
  }

  if(!status.value){
    alert("Select Status");
    return;
  }

  if(!windows.value){
    alert("Select Windows Activated Status");
    return;
  }

  const data={
    solid:solid.value,
    solname:solname.value,
    asset:asset.value,
    brand:brand.value,
    model:model.value,
    serial:serial.value,
    assigned:assigned.value,
    critical:critical.value,
    ip:"",
    host:"",
    os:"",
    mac:"",
    status:status.value,
    windows:windows.value
  };

  fetch(API_URL,{
    method:"POST",
    body:JSON.stringify(data)
  })
  .then(res=>res.json())
  .then(()=>{
    alert("Hardware Asset Saved Successfully");

    document.querySelectorAll("input").forEach(i=>i.value="");
    asset.value="";
    status.value="";
    windows.value="";
    branch.value="";
  });
}

loadBranches();

</script>

</body>
</html>
