<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>RO Jabalpur Inventory</title>

<style>
body{
  font-family:Arial;
  background:#f4f6f9;
  padding:20px;
}

h2{
  text-align:center;
  color:#006400;
}

.card{
  background:white;
  padding:20px;
  border-radius:10px;
  box-shadow:0 4px 8px rgba(0,0,0,0.1);
}

input,select{
  width:100%;
  padding:8px;
  margin:6px 0;
  border:1px solid #ccc;
  border-radius:4px;
}

button{
  padding:10px;
  background:#006400;
  color:white;
  border:none;
  width:100%;
  border-radius:5px;
  margin-top:10px;
  font-weight:bold;
}
</style>

</head>
<body>

<h2>RO Jabalpur Hardware Inventory</h2>

<div class="card">

<select id="branch"></select>
<input id="solid" placeholder="SOL ID" readonly>
<input id="solname" placeholder="SOL Name" readonly>

<select id="asset">
  <option value="">Select Asset Type</option>
  <option>CPU</option>
  <option>MONITOR</option>
  <option>SCANNER</option>
  <option>PASSBOOK PRINTER</option>
  <option>LASER PRINTER</option>
  <option>BIOMETRIC DEVICE</option>
  <option>MODEM</option>
  <option>ROUTER</option>
  <option>VC DEVICE</option>
  <option>LED PROJECTOR</option>
  <option>PROJECTOR SCREEN</option>
  <option>SPEAKER</option>
</select>

<input id="brand" placeholder="Brand">
<input id="model" placeholder="Model">
<input id="serial" placeholder="Serial No">
<input id="assigned" placeholder="Assigned To">

<select id="critical">
  <option>LOW</option>
  <option>MEDIUM</option>
  <option>HIGH</option>
</select>

<input id="ip" placeholder="IP Address">
<input id="host" placeholder="Hostname">
<input id="os" placeholder="Operating System">
<input id="mac" placeholder="MAC Address">

<select id="status">
  <option value="">Select Status</option>
  <option>WORKING</option>
  <option>FAULTY</option>
  <option>UNDER REPAIR</option>
  <option>SCRAP</option>
</select>

<select id="windows">
  <option value="">Windows Activated?</option>
  <option>YES</option>
  <option>NO</option>
</select>

<button onclick="saveData()">Save Asset</button>

</div>

<script>

// ðŸ”µ IMPORTANT: Your Apps Script URL
const API_URL = "https://script.google.com/macros/s/AKfycbyLQTvwbvI8kDG_ONaAHg0Aj9U6uBp7yWFxUjcgL8RqhDvI5Qr_q3Us1y9mrmsCq0ye/exec";

// Load Branch List
function loadBranches(){

  fetch(API_URL + "?type=branches")
  .then(res=>res.json())
  .then(data=>{

    const select=document.getElementById("branch");
    select.innerHTML="<option value=''>Select Branch</option>";

    data.forEach(row=>{
      let option=document.createElement("option");
      option.value=row[0];
      option.text=row[0]+" - "+row[1];
      select.appendChild(option);
    });

  }).catch(()=>{
    alert("Error loading branches");
  });
}

// Set SOL
document.getElementById("branch").addEventListener("change",function(){

  const text=this.options[this.selectedIndex].text;

  solid.value=this.value;
  solname.value=text.includes(" - ") ? text.split(" - ")[1] : "";
});


// Save Data
function saveData(){

  if(!branch.value) return alert("Select Branch");
  if(!asset.value) return alert("Select Asset Type");
  if(!serial.value.trim()) return alert("Serial Number required");
  if(!status.value) return alert("Select Status");
  if(!windows.value) return alert("Select Windows Activated");

  const formData = new FormData();

  formData.append("solid", solid.value);
  formData.append("solname", solname.value);
  formData.append("asset", asset.value);
  formData.append("brand", brand.value);
  formData.append("model", model.value);
  formData.append("serial", serial.value);
  formData.append("assigned", assigned.value);
  formData.append("critical", critical.value);
  formData.append("ip", ip.value);
  formData.append("host", host.value);
  formData.append("os", os.value);
  formData.append("mac", mac.value);
  formData.append("status", status.value);
  formData.append("windows", windows.value);

  fetch(API_URL,{
    method:"POST",
    body:formData
  })
  .then(res=>res.text())
  .then(res=>{
    if(res.includes("success")){
      alert("Asset Saved Successfully");
      location.reload();
    }else{
      alert("Server Error: "+res);
    }
  })
  .catch(err=>{
    alert("Network Error: "+err);
  });

}

loadBranches();

</script>

</body>
</html>
