<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mandate Followup</title>

<style>
body{
    font-family: Arial;
    background:#f4f6f9;
    padding:6px;
}

h2{
    text-align:center;
    color:#003366;
    font-size:15px;
    margin-bottom:6px;
}

.table-container{
    overflow-x:auto;
}

table{
    border-collapse:collapse;
    background:white;
    font-size:11px;
    width:100%;
}

th, td{
    border:1px solid #ccc;
    padding:3px 4px;
    white-space:nowrap;
}

th{
    background:#003366;
    color:white;
    text-align:center;
}

td{
    text-align:center;
}

td:nth-child(2),
td:nth-child(11){
    text-align:left;
}

.total-row{
    background:#ffeeba;
    font-weight:bold;
}

</style>
</head>

<body>

<h2>Mandate Followup - Branch Wise List</h2>

<div class="table-container">
<table id="data-table"></table>
</div>

<script>

const csvURL = "PASTE_YOUR_PUBLISH_TO_WEB_CSV_LINK_HERE";

fetch(csvURL)
.then(res => res.text())
.then(data => {

    let rows = data.split("\n").map(r => r.split(","));
    let tableHTML = "";

    rows.forEach((row,index)=>{

        if(row.every(cell => cell.trim()==="")) return;

        let isTotal = row[0].toLowerCase().includes("grand");

        tableHTML += `<tr class="${isTotal?'total-row':''}">`;

        row.forEach(cell=>{
            if(index===0){
                tableHTML += `<th>${cell}</th>`;
            }else{
                tableHTML += `<td>${cell}</td>`;
            }
        });

        tableHTML += "</tr>";
    });

    document.getElementById("data-table").innerHTML = tableHTML;

});

</script>

</body>
</html>
