<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mandate Followup</title>

<style>
body{
    font-family: Arial;
    background:#f4f6f9;
    padding:15px;
}

h2{
    text-align:center;
    color:#003366;
}

table{
    width:100%;
    border-collapse:collapse;
    background:white;
}

th, td{
    border:1px solid #ddd;
    padding:6px;
    text-align:center;
    font-size:13px;
}

th{
    background:#003366;
    color:white;
    position:sticky;
    top:0;
}

.total-row{
    background:#ffeeba;
    font-weight:bold;
}
</style>
</head>

<body>

<h2>Mandate Followup - Branch Wise List</h2>

<table id="data-table">
<thead></thead>
<tbody></tbody>
</table>

<script>

const sheetID = "1P_fY12UDjVvFgO-cfHtFEqBhBIWYGMjyloCuSIF9eMs";
const sheetName = "Sheet1";   // Agar sheet ka naam alag hai to yaha change karein

const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

fetch(url)
.then(res => res.text())
.then(rep => {

    const json = JSON.parse(rep.substr(47).slice(0, -2));
    const rows = json.table.rows;
    const cols = json.table.cols;

    const thead = document.querySelector("#data-table thead");
    const tbody = document.querySelector("#data-table tbody");

    // Header
    let header = "<tr>";
    cols.forEach(col=>{
        header += `<th>${col.label}</th>`;
    });
    header += "</tr>";
    thead.innerHTML = header;

    // Data
    rows.forEach(row=>{
        if(!row.c) return;

        let firstCell = row.c[0] ? row.c[0].v : "";
        let isTotal = firstCell && firstCell.toString().toLowerCase().includes("grand");

        let tr = `<tr class="${isTotal ? 'total-row' : ''}">`;

        row.c.forEach(cell=>{
            tr += `<td>${cell ? cell.v : ""}</td>`;
        });

        tr += "</tr>";
        tbody.innerHTML += tr;
    });

});

</script>

</body>
</html>
