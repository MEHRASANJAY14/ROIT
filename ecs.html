<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mandate Followup</title>

<style>
body{
    font-family: Arial;
    background:#eef7f1;
    padding:6px;
}
    .back{
  display:block;
  text-align:center;
  margin-top:20px;
  text-decoration:none;
  color:#006400;
  font-weight:bold;
}

h2{
    text-align:center;
    color:#0a5c36;
    font-size:16px;
    margin-bottom:8px;
}

.table-container{
    max-height:85vh;
    overflow:auto;
    border:1px solid #b7e1cd;
}

table{
    border-collapse:collapse;
    width:100%;
    font-size:12px;
    background:white;
}

th, td{
    border:1px solid #d0e7db;
    padding:5px 6px;
}

th{
    background:#1e7f4f;
    color:white;
    position:sticky;
    top:0;
    z-index:2;
    text-align:center;
}

/* Default center for numbers */
td{
    text-align:center;
}

/* SOL DESC full readable */
td:nth-child(2){
    text-align:left;
    min-width:180px;
    font-weight:500;
}

/* BM NAME full readable */
td:last-child{
    text-align:left;
    min-width:170px;
}

/* Alternate row color */
tr:nth-child(even){
    background:#f3fbf7;
}

/* Grand Total highlight */
.total-row{
    background:#c6f2df !important;
    font-weight:bold;
}

</style>
</head>

<body>

<h2>Mandate Followup - Branch Wise List</h2>

<div class="table-container">
<table id="data-table">
<thead></thead>
<tbody></tbody>
</table>
<a href="index.html" class="back">⬅ Back to Dashboard</a>
</div>

<script>

const sheetID = "1P_fY12UDjVvFgO-cfHtFEqBhBIWYGMjyloCuSIF9eMs";
const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json`;

fetch(url)
.then(res => res.text())
.then(data => {

    const json = JSON.parse(data.substring(47).slice(0, -2));
    const cols = json.table.cols;
    const rows = json.table.rows;

    const shortNames = {
        "Sol Id":"SOL",
        "SOL DESC":"BRANCH",
        "Personal Loan":"PL",
        "Car Loan":"CL",
        "LAP":"LAP",
        "House Loan":"HL",
        "Grand Total":"TOTAL",
        "Total branch RequestedMandate":"REQ",
        "Total Accepted":"ACC",
        "BM_NAME":"BM"
    };

    let headerHTML = "<tr>";
    cols.forEach(col=>{
        let label = col.label.trim();
        headerHTML += `<th>${shortNames[label] || label}</th>`;
    });
    headerHTML += "</tr>";

    document.querySelector("#data-table thead").innerHTML = headerHTML;

    let bodyHTML = "";

    rows.forEach(row=>{
        if(!row.c) return;

        let firstCell = row.c[0]?.v || "";
        let isTotal = firstCell.toString().toLowerCase().includes("grand");

        bodyHTML += `<tr class="${isTotal?'total-row':''}">`;

        row.c.forEach(cell=>{
            bodyHTML += `<td>${cell ? cell.v : ""}</td>`;
        });

        bodyHTML += "</tr>";
    });

    document.querySelector("#data-table tbody").innerHTML = bodyHTML;

})
.catch(()=>{
    document.body.innerHTML += "<p style='color:red;text-align:center;'>⚠ Sheet access error</p>";
});

</script>

</body>
</html>

