<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>RO Jabalpur Inventory</title>

<style>
body{
  font-family:Arial;
  background:#f4f6f9;
  padding:20px
}
.card{
  background:white;
  padding:20px;
  border-radius:8px;
  box-shadow:0 4px 8px rgba(0,0,0,0.1)
}
input,select{
  width:100%;
  padding:8px;
  margin:6px 0;
  border:1px solid #ccc;
  border-radius:4px
}
button{
  padding:10px;
  background:#007bff;
  color:white;
  border:none;
  width:100%;
  border-radius:5px;
  margin-top:10px
}
h3{text-align:center}
</style>

</head>
<body>

<div class="card">

<h3>RO Jabalpur Inventory Entry</h3>

<!-- Branch Dropdown -->
<select id="branch"></select>

<input id="solid" placeholder="SOL ID" readonly>
<input id="solname" placeholder="SOL NAME" readonly>

<select id="asset">
  <option value="">Select Asset Type</option>
  <option>CPU</option>
  <option>MONITOR</option>
  <option>SCANNER</option>
  <option>PASSBOOK PRINTER</option>
  <option>LASER PRINTER</option>
  <option>BIOMETRIC DEVICE</option>
  <option>MODEM</option>
  <option>ROUTER</option>
  <option>VC DEVICE</option>
  <option>LED PROJECTOR</option>
  <option>PROJECTOR SCREEN</option>
  <option>SPEAKER</option>
</select>

<input id="brand" placeholder="Brand">
<input id="model" placeholder="Model">
<input id="serial" placeholder="Serial No">
<input id="assigned" placeholder="Assigned To">

<select id="critical">
  <option value="LOW">LOW</option>
  <option value="MEDIUM">MEDIUM</option>
  <option value="HIGH">HIGH</option>
</select>

<input id="ip" placeholder="IP Address">
<input id="host" placeholder="Hostname">
<input id="os" placeholder="Operating System">
<input id="mac" placeholder="MAC Address">

<select id="status">
  <option value="">Select Status</option>
  <option>WORKING</option>
  <option>FAULTY</option>
  <option>UNDER REPAIR</option>
  <option>SCRAP</option>
</select>

<button onclick="saveData()">Save Asset</button>

</div>

<script>

const API_URL = "https://script.google.com/macros/s/AKfycbz6gx8Ko_Kpgoof9v1gCOy4ajQsNm2O_iL3IM6o2aGHaYYF0QD25q_PxSAyC-uGFcc/exec";


// ðŸ”¹ Load Branches from Google Sheet
function loadBranches(){
  fetch(API_URL + "?type=branches")
  .then(res => res.json())
  .then(data => {
    const select = document.getElementById("branch");
    select.innerHTML = "<option value=''>Select Branch</option>";
    data.forEach(row => {
      let option = document.createElement("option");
      option.value = row[0];
      option.text = row[0] + " - " + row[1];
      select.appendChild(option);
    });
  })
  .catch(err=>{
    alert("Branch Load Error");
    console.log(err);
  });
}


// ðŸ”¹ When Branch Selected
document.addEventListener("change", function(e){
  if(e.target.id=="branch"){
    const selectedText = e.target.options[e.target.selectedIndex].text;
    document.getElementById("solid").value = e.target.value;
    document.getElementById("solname").value = selectedText.split(" - ")[1];
  }
});


// ðŸ”¹ Save Data
function saveData(){

  const branch = document.getElementById("branch");
  const asset = document.getElementById("asset");
  const status = document.getElementById("status");

  if(!branch.value){
    alert("Please Select Branch");
    return;
  }

  if(!asset.value){
    alert("Please Select Asset Type");
    return;
  }

  if(!status.value){
    alert("Please Select Status");
    return;
  }

  const data = {
    solid: document.getElementById("solid").value,
    solname: document.getElementById("solname").value,
    asset: asset.value,
    brand: document.getElementById("brand").value,
    model: document.getElementById("model").value,
    serial: document.getElementById("serial").value,
    assigned: document.getElementById("assigned").value,
    critical: document.getElementById("critical").value,
    ip: document.getElementById("ip").value,
    host: document.getElementById("host").value,
    os: document.getElementById("os").value,
    mac: document.getElementById("mac").value,
    status: status.value
  };

  fetch(API_URL, {
    method: "POST",
    body: JSON.stringify(data)
  })
  .then(res => res.json())
  .then(resp => {
    alert("Saved Successfully");
    document.querySelectorAll("input").forEach(i=>i.value="");
    branch.value="";
    asset.value="";
    status.value="";
  })
  .catch(err=>{
    alert("Error Saving Data");
    console.log(err);
  });
}


loadBranches();

</script>

</body>
</html>
